var dust=function(){this.x=50,this.y=50,this.vx=2*Math.random()+2,this.vy=2*Math.random(),this.color="#fff",this.shadowBlur=3*Math.random(),this.shadowX=2*Math.random()-1,this.shadowY=2*Math.random()-1,this.radiusX=3*Math.random(),this.radiusY=3*Math.random(),this.rotation=Math.PI*Math.floor(2*Math.random())},canvasDust=function(){function t(t){var e=this;this.width=300,this.height=300,this.dustQuantity=50,this.dustArr=[];var s=document.getElementById(t);if(!s)throw new Error("canvasID 无效");this.canvas=s,this.ctx=s.getContext("2d"),this.build(),window.addEventListener("resize",(function(){return e.resize()}))}return t.prototype.build=function(){var e=this;if(this.resize(),this.ctx){for(var s=0,i=t.getPoint(this.dustQuantity);s<i.length;s++){var n=i[s],o=new dust;this.buildDust(n[0],n[1],o),this.dustArr.push(o)}setInterval((function(){e.play()}),40)}},t.prototype.play=function(){var t,e=this.dustArr;null===(t=this.ctx)||void 0===t||t.clearRect(0,0,this.width,this.height);for(var s=0,i=e;s<i.length;s++){var n=i[s];if(n.x<0||n.y<0){var o=this.width,r=Math.floor(Math.random()*window.innerHeight);n.x=o,n.y=r,this.buildDust(o,r,n)}else{o=n.x-n.vx,r=n.y-n.vy;this.buildDust(o,r,n)}}},t.prototype.buildDust=function(t,e,s){var i=this.ctx;t&&(s.x=t),e&&(s.y=e),i&&(i.beginPath(),i.shadowBlur=s.shadowBlur,i.shadowColor=s.color,i.shadowOffsetX=s.shadowX,i.shadowOffsetY=s.shadowY,i.ellipse(s.x,s.y,s.radiusX,s.radiusY,s.rotation,0,2*Math.PI),i.closePath(),i.fillStyle=s.color,i.fill())},t.prototype.resize=function(){var t=this.canvas,e=window.innerWidth,s=window.innerHeight;this.width=e,this.height=s,this.dustQuantity=Math.floor((e+s)/38),void 0!==t&&(t.width=e,t.height=s)},t.getPoint=function(t){void 0===t&&(t=1);for(var e=[],s=0;s<t;s++){var i=Math.floor(Math.random()*window.innerWidth),n=Math.floor(Math.random()*window.innerHeight);e.push([i,n])}return e},t}(),indexs=function(){function t(){var t=this;this.index=[],this.totop=document.getElementById("to-top"),this.scrollID=null,this.scrolling=0,this.headerLink=document.getElementsByClassName("headerlink"),this.tocLink=document.getElementsByClassName("toc-link"),this.postContent=document.getElementById("post-content");var e=document.getElementById("to-top");null!=e&&(e.style.opacity="0"),this.tocLink.length>0&&(this.setItem(this.tocLink.item(0)),document.addEventListener("scroll",(function(){++t.scrolling,null==t.scrollID&&(t.scrollID=setInterval(t.modifyIndex.bind(t),50)),setTimeout((function(){if(0==--t.scrolling){clearInterval(t.scrollID),t.scrollID=null;var e=document.getElementById("to-top");null!==t.totop&&document.getElementById("post-title").getBoundingClientRect().top<-200?e.style.opacity="1":e.style.opacity="0"}}),200)}),{passive:!0}))}return t.prototype.setItem=function(t){t.classList.add("active");for(var e=t.parentElement.children,s=0;s<e.length;s++){var i=e.item(s);if(i.classList.contains("toc-child")){i.classList.add("has-active");break}}for(var n=t.parentElement;"toc"!=n.classList[0];n=n.parentElement)"toc-child"==n.classList[0]&&n.classList.add("has-active")},t.prototype.reset=function(){for(var t=document.getElementsByClassName("active"),e=document.getElementsByClassName("has-active");t.length;){t.item(0).classList.remove("active")}for(;e.length;){e.item(0).classList.remove("has-active")}},t.prototype.modifyIndex=function(){for(var t=0;t<this.headerLink.length;t++){var e=this.headerLink.item(t);e&&this.index.push(e.getBoundingClientRect().top)}this.reset();for(t=0;t<this.tocLink.length;++t){var s=this.tocLink.item(t);if(t+1==this.index.length||this.index[t+1]>150&&(this.index[t]<=150||0==t)){this.setItem(s);break}}this.index=[]},t.prototype.scrolltop=function(){window.scroll({top:0,left:0,behavior:"smooth"}),document.getElementById("to-top").style.opacity="0"},t}(),codes=function(){function t(){this.findCode()}return t.prototype.reverse=function(t,e,s){var i=t.parentElement;i.classList.contains(e)?(i.classList.remove(e),i.classList.add(s)):(i.classList.remove(s),i.classList.add(e))},t.prototype.doAsMermaid=function(t){var e=t.getElementsByClassName("mermaid").item(0);t.outerHTML='<div class="highlight mermaid">'+e.innerText+"</div>"},t.prototype.resetName=function(t){return"plaintext"==t?"TEXT":"cs"==t?"C#":t.toUpperCase()},t.prototype.doAsCode=function(t){var e=this,s=t.classList[1],i=t.getElementsByClassName("gutter").item(0).children[0].childElementCount>>1;t.classList.add(i<16?"open":"fold"),t.innerHTML='<span class="code-header"><span class="code-title">        <div class="code-icon"></div>'+this.resetName(s)+" 共 "+i+' 行</span>        <span class="code-header-tail">          <button class="code-copy"></button>          <span class="code-space">展开</span>        </span>    </span></span>    <div class="code-box">'+t.innerHTML+"</div>",t.getElementsByClassName("code-copy").item(0).addEventListener("click",(function(e){var s=e.target;navigator.clipboard.writeText(t.getElementsByTagName("code").item(0).innerText),s.classList.add("copied"),setTimeout((function(){return s.classList.remove("copied")}),1200)})),t.getElementsByClassName("code-header").item(0).addEventListener("click",(function(t){t.target.classList.contains("code-copy")||e.reverse(t.currentTarget,"open","fold")}))},t.prototype.findCode=function(){for(var t=document.getElementsByClassName("highlight"),e=0;e<t.length;e++){var s=t.item(e);s.getElementsByClassName("mermaid").length>0?this.doAsMermaid(s):this.doAsCode(s)}},t}(),cursors=function(){function t(){var t=this;this.first=!0,this.outer=document.getElementById("cursor-outer").style,this.effecter=document.getElementById("cursor-effect").style,this.opacity=0,this.ishead=!0,this.moveEventID=null,this.fadeEventID=null,document.querySelector("header").addEventListener("mouseenter",(function(){return t.ishead=!0}),{passive:!0}),document.querySelector("header").addEventListener("mouseout",(function(){return t.ishead=!1}),{passive:!0}),window.addEventListener("mousemove",(function(e){return t.reset(e)}),{passive:!0}),window.addEventListener("click",(function(e){return t.Aeffect(e)}),{passive:!0}),this.pushHolders(),new MutationObserver(this.pushHolders.bind(this)).observe(document,{childList:!0,subtree:!0})}return t.prototype.move=function(){if(void 0!==this.now){var t=this.outer.left,e=this.outer.top,s=Number(t.substring(0,t.length-2)),i=Number(e.substring(0,e.length-2)),n=this.now.x,o=this.now.y,r=(n-s)/13,a=(o-i)/13,h=!0;Math.abs(r)>=.1?(this.outer.left=String(s+r)+"px",h=!1):this.outer.left=String(n)+"px",Math.abs(a)>=.1?(this.outer.top=String(i+a)+"px",h=!1):this.outer.top=String(o)+"px",h&&(clearInterval(this.moveEventID),this.moveEventID=null)}},t.prototype.reset=function(t){null===this.moveEventID&&(this.moveEventID=window.setInterval(this.move.bind(this),1)),this.now=t,this.first&&(this.first=!1,this.outer.left=String(this.now.x)+"px",this.outer.top=String(this.now.y)+"px")},t.prototype.fadeOut=function(){if(this.opacity>0){var t=.11*this.opacity;t<.001&&(t=this.opacity),this.effecter.transform="translate(-50%, -50%) scale("+String(this.scale+=t)+")",this.effecter.opacity=String(this.opacity-=t)}else clearInterval(this.fadeEventID),this.fadeEventID=null},t.prototype.Aeffect=function(t){null===this.fadeEventID&&(this.fadeEventID=window.setInterval(this.fadeOut.bind(this),10),this.effecter.left=String(t.x)+"px",this.effecter.top=String(t.y)+"px",this.effecter.transform="translate(-50%, -50%) scale(0)",this.effecter.opacity="1",this.scale=0,this.opacity=1)},t.prototype.hold=function(){this.outer.height="24px",this.outer.width="24px",this.outer.background="rgba(255, 255, 255, 0.5)"},t.prototype.relax=function(){this.outer.height="36px",this.outer.width="36px",this.outer.background="unset"},t.prototype.pushHolder=function(t){for(var e=this,s=0;s<t.length;s++){var i=t.item(s);i.addEventListener("mouseover",(function(){return e.hold()}),{passive:!0}),i.addEventListener("mouseout",(function(){return e.relax()}),{passive:!0})}},t.prototype.pushHolders=function(){this.pushHolder(document.getElementsByTagName("a")),this.pushHolder(document.getElementsByTagName("input")),this.pushHolder(document.getElementsByTagName("button")),this.pushHolder(document.getElementsByClassName("code-header")),this.pushHolder(document.getElementsByClassName("gt-user-inner")),this.pushHolder(document.getElementsByClassName("gt-header-textarea"))},t}(),index=new indexs,code=new codes,cursor=new cursors;new canvasDust("canvas-dust");